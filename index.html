<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Berkay Sports ·¥¥·¥∞ - Canlƒ± Yayƒ±n</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body {margin:0; padding:0; font-family:'Poppins',sans-serif; background:radial-gradient(circle at top,#050505 0%,#000 100%); color:#fff; display:flex; flex-direction:column; align-items:center; min-height:100vh;}
  header img {width:55%; max-width:700px; margin:40px auto 20px; display:block;}
  .button-row{display:flex; gap:12px; margin-bottom:25px; flex-wrap:wrap; justify-content:center;}
  button{padding:12px 24px; font-weight:600; border:none; border-radius:10px; cursor:pointer; transition:all 0.25s ease; box-shadow:0 0 20px rgba(0,255,100,0.3);}
  #hesapBtn{background:linear-gradient(145deg,#00ff88,#007a3d); color:#000;}
  #hesapBtn:hover{transform:scale(1.05); box-shadow:0 0 30px rgba(0,255,100,0.6);}
  #logoutBtn{background:#111; color:#fff; border:1px solid #00ff6a;}
  #logoutBtn:hover{background:#00ff6a; color:#000; transform:scale(1.05); box-shadow:0 0 25px rgba(0,255,100,0.6);}
  .kanal-row {display:flex; gap:10px; justify-content:center; margin-bottom:15px;}
  .kanal-btn {background:#00ff6a; color:#000; padding:10px 22px; border:none; border-radius:8px; cursor:pointer; font-weight:600; transition:0.3s;}
  .kanal-btn:hover {background:#00cc55;}
  .kanal-btn.active {background:#111; color:#00ff6a; border:1px solid #00ff6a;}
  #player-container{position:relative; width:92%; max-width:960px; aspect-ratio:16/9; background:#111; border-radius:20px; overflow:hidden; border:2px solid rgba(0,255,100,0.2);}
  #player{width:100%; height:100%;}
  #player iframe{width:100%; height:100%; border:none;}
  .hesaplar-alani{margin-top:25px; text-align:center;}
  .hesaplar-alani button{font-size:18px; padding:15px 30px; border-radius:12px;}
  .aciklama{margin-top:15px; font-size:14px; color:#00ff88; max-width:600px; text-align:center; line-height:1.6; background:rgba(0,255,100,0.05); border:1px solid rgba(0,255,100,0.3); border-radius:10px; padding:12px 16px; box-shadow:0 0 15px rgba(0,255,100,0.3); animation:glow 2.2s infinite alternate;}
  @keyframes glow {from {box-shadow:0 0 10px rgba(0,255,100,0.2);} to {box-shadow:0 0 25px rgba(0,255,100,0.5);}}
  footer{margin-top:35px; font-size:13px; color:#777; text-align:center; padding-bottom:20px;}
  #logoutPopup, #premiumPopup, #devicePopup{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:9999;}
  .popup-content{position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#111; border:2px solid #00ff6a; border-radius:12px; padding:30px 25px; text-align:center; width:90%; max-width:400px; box-shadow:0 0 30px rgba(0,255,100,0.4);}
  #devicePopup .popup-content{border-color:#ff4040; box-shadow:0 0 25px rgba(255,64,64,0.5);}
  #devicePopup h3{color:#ff4040;}
  .popup-content p{color:#ccc; margin-bottom:20px;}
  .popup-buttons{display:flex; justify-content:center; gap:15px;}
  .popup-buttons button{padding:10px 20px; font-weight:600; border:none; border-radius:8px; cursor:pointer; transition:0.3s;}
  #confirmLogout{background:#ff4040;color:#fff;}
  #confirmLogout:hover{box-shadow:0 0 20px rgba(255,64,64,0.6);}
  #cancelLogout,#closePremium,#closeDevicePopup{background:#00ff6a;color:#000;}
  #cancelLogout:hover,#closePremium:hover,#closeDevicePopup:hover{box-shadow:0 0 20px rgba(0,255,100,0.6);}
</style>
</head>
<body>

<header>
  <img src="https://i.hizliresim.com/jfr3abq.png" alt="Berkay Sports Logo">
</header>

<div class="button-row">
  <button id="logoutBtn">√áƒ±kƒ±≈ü Yap</button>
</div>

<div class="kanal-row">
  <button class="kanal-btn active" id="kanal1Btn">Bein Sport 1</button>
  <button class="kanal-btn" id="kanal2Btn">Tabi Spor / TRT 1</button>
</div>

<div id="player-container"><div id="player"></div></div>

<div class="hesaplar-alani">
  <button id="hesapBtn"><i class="fa-solid fa-list"></i> Hesaplara Ula≈ü</button>
  <div class="aciklama">
    ‚ö†Ô∏è <b>Crack hesaplara buradan ula≈üƒ±n.</b><br>
    Bu hesaplar payla≈üƒ±m ama√ßlƒ±dƒ±r, s√ºreleri yoktur.<br>
    <b>L√úTFEN!</b> ≈ûifreleri deƒüi≈ütirmeyin!
  </div>
</div>

<!-- Popuplar -->
<div id="logoutPopup">
  <div class="popup-content">
    <p>√áƒ±kƒ±≈ü yapmak istediƒüinizden emin misiniz?</p>
    <div class="popup-buttons">
      <button id="confirmLogout">Evet</button>
      <button id="cancelLogout">Hayƒ±r</button>
    </div>
  </div>
</div>

<div id="premiumPopup">
  <div class="popup-content">
    <h3><i class="fa-solid fa-lock"></i> Premium Gerekli</h3>
    <p>Bu alana eri≈ümek i√ßin Premium √ºyelik gereklidir!</p>
    <button id="closePremium">Tamam</button>
  </div>
</div>

<div id="devicePopup">
  <div class="popup-content">
    <h3><i class="fa-solid fa-triangle-exclamation"></i> Oturum Kapatƒ±ldƒ±!</h3>
    <p>Bu hesap ba≈üka bir cihazda aktif hale geldi.<br>Oturumunuz sonlandƒ±rƒ±ldƒ±.</p>
    <button id="closeDevicePopup">Tamam</button>
  </div>
</div>

<footer>¬© 2025 Berkay Sports ‚Äì T√ºm Haklarƒ± Saklƒ±dƒ±r.</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, onValue, get, update, onDisconnect } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyBbw4RJ06sWl5EciDHtB3YaNOu0uK78-Mc",
  authDomain: "berkaysports-ada49.firebaseapp.com",
  databaseURL: "https://berkaysports-ada49-default-rtdb.firebaseio.com",
  projectId: "berkaysports-ada49",
  storageBucket: "berkaysports-ada49.firebasestorage.app",
  messagingSenderId: "781158171391",
  appId: "1:781158171391:web:3c13b6975a6739e4ad42ca",
  measurementId: "G-DJZWF8ZLEP",
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// Device ID
let deviceId = localStorage.getItem("deviceId");
if(!deviceId){
  deviceId = crypto.randomUUID();
  localStorage.setItem("deviceId", deviceId);
}

// Kullanƒ±cƒ±
const currentUserData = localStorage.getItem("berkaySportsUser");
const user = currentUserData ? JSON.parse(currentUserData) : null;
const userRef = user ? ref(db,"kullanicilar/"+user.username) : null;
const siteDurumuRef = ref(db,"siteDurumu");

// üîí Tek cihaz korumasƒ± + popup
async function kontrolEtGercekZamanli(){
  if(!userRef) return;
  const snap = await get(userRef);
  const data = snap.val();

  if(!data){
    localStorage.removeItem("berkaySportsUser");
    window.location.href="login.html";
    return;
  }

  if(data.ban){
    alert("Hesabƒ±nƒ±z banlanmƒ±≈ü!");
    localStorage.removeItem("berkaySportsUser");
    window.location.href="login.html";
    return;
  }

  await update(userRef, {online:true, currentDeviceId:deviceId, sonGiris:new Date().toISOString()});
  onDisconnect(userRef).update({online:false,currentDeviceId:null});

  onValue(userRef, (s)=>{
    const u = s.val();
    if(u && u.currentDeviceId && u.currentDeviceId!==deviceId){
      // Popup g√∂ster
      const popup=document.getElementById("devicePopup");
      popup.style.display="flex";
      document.getElementById("closeDevicePopup").onclick=()=>{
        popup.style.display="none";
        localStorage.removeItem("berkaySportsUser");
        window.location.href="login.html";
      };
    }
  });
}

// üî¥ Yayƒ±n linkleri
let kanal1Link="", kanal2Link="", currentChannel=1;
const playerDiv=document.getElementById("player");
const kanal1Btn=document.getElementById("kanal1Btn");
const kanal2Btn=document.getElementById("kanal2Btn");

onValue(ref(db,"yayinLink1"), snap=>{
  kanal1Link=snap.val()||"";
  if(currentChannel===1) oynat(kanal1Link);
});
onValue(ref(db,"yayinLink2"), snap=>{
  kanal2Link=snap.val()||"";
  if(currentChannel===2) oynat(kanal2Link);
});

function oynat(link){
  if(link){
    playerDiv.innerHTML=`<iframe src="${link}" allowfullscreen allow="autoplay; encrypted-media"></iframe>`;
  }else{
    playerDiv.innerHTML=`<p style="text-align:center;color:#999;margin-top:40%;">Yayƒ±n linki bulunamadƒ±.</p>`;
  }
}

// üîÅ Kanal ge√ßi≈üleri
kanal1Btn.onclick=()=>{currentChannel=1;oynat(kanal1Link);kanal1Btn.classList.add("active");kanal2Btn.classList.remove("active");};
kanal2Btn.onclick=()=>{currentChannel=2;oynat(kanal2Link);kanal2Btn.classList.add("active");kanal1Btn.classList.remove("active");};

// üîê Site durumu (Free / Premium)
const hesapBtn=document.getElementById("hesapBtn");
const premiumPopup=document.getElementById("premiumPopup");

onValue(siteDurumuRef, async (snap)=>{
  const durum=snap.val()||"premium";

  if(durum==="ucretsiz"){
    // Free mod
    oynat(currentChannel===1?kanal1Link:kanal2Link);
  }else{
    // Premium mod
    if(!currentUserData){window.location.href="login.html";return;}
    await kontrolEtGercekZamanli();
    oynat(currentChannel===1?kanal1Link:kanal2Link);
  }

  hesapBtn.onclick=()=>{
    if(durum==="premium"){
      window.location.href="hesap.html";
    }else{
      premiumPopup.style.display="flex";
    }
  };
});

// üîö √áƒ±kƒ±≈ü i≈ülemleri
const logoutBtn=document.getElementById("logoutBtn");
const logoutPopup=document.getElementById("logoutPopup");
document.getElementById("cancelLogout").onclick=()=>logoutPopup.style.display="none";
logoutBtn.onclick=()=>logoutPopup.style.display="flex";
document.getElementById("confirmLogout").onclick=()=>{
  if(userRef) update(userRef,{online:false,currentDeviceId:null});
  localStorage.removeItem("berkaySportsUser");
  window.location.href="login.html";
};
document.getElementById("closePremium").onclick=()=>premiumPopup.style.display="none";
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/js/all.min.js"></script>
</body>
</html>
